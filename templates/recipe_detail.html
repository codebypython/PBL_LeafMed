{% extends "base.html" %}
{% block content %}
<div class="card">
    <div class="recipe-header">
        <div class="recipe-title-section">
            <h1>{{ recipe.name }}</h1>
            <div class="recipe-badges">
                <span class="badge badge-info">{{ recipe.get_recipe_type_display }}</span>
                <span class="badge {% if recipe.difficulty == 'easy' %}badge-success{% elif recipe.difficulty == 'medium' %}badge-info{% else %}badge-danger{% endif %}">
                    {{ recipe.get_difficulty_display }}
                </span>
                {% if recipe.is_verified %}
                    <span class="badge badge-success">âœ“ ÄÃ£ xÃ¡c thá»±c</span>
                {% endif %}
            </div>
        </div>
        <a href="{% url 'plant_detail' recipe.plant.id %}" class="btn btn-outline">
            â† Vá» {{ recipe.plant.name }}
        </a>
    </div>

    <!-- Recipe Image -->
    <div class="recipe-image-section">
        {% if recipe.image %}
            <img src="{{ recipe.image.url }}" alt="{{ recipe.name }}" class="recipe-main-image">
        {% else %}
            <div class="recipe-image-placeholder">
                <span class="recipe-type-icon">{{ recipe.get_recipe_type_display|slice:":1" }}</span>
                <p class="image-placeholder-text">áº¢nh minh há»a sáº½ Ä‘Æ°á»£c cáº­p nháº­t</p>
            </div>
        {% endif %}
    </div>

    {% if recipe.description %}
        <div class="info-section">
            <p style="font-size: 1.1rem; color: var(--text-secondary);">{{ recipe.description }}</p>
        </div>
    {% endif %}

    <!-- ThÃ´ng tin nhanh -->
    <div class="recipe-quick-info">
        <div class="quick-info-item">
            <span class="quick-info-label">CÃ¡ch dÃ¹ng</span>
            <span class="quick-info-value">{{ recipe.get_usage_method_display }}</span>
        </div>
        {% if recipe.preparation_time %}
        <div class="quick-info-item">
            <span class="quick-info-label">Thá»i gian</span>
            <span class="quick-info-value">{{ recipe.preparation_time }} phÃºt</span>
        </div>
        {% endif %}
        <div class="quick-info-item">
            <span class="quick-info-label">Äá»™ phá»• biáº¿n</span>
            <span class="quick-info-value">ğŸ‘ {{ recipe.popularity }} lÆ°á»£t xem</span>
        </div>
    </div>

    <!-- CÃ´ng dá»¥ng -->
    {% if recipe.treats or recipe.benefits %}
    <div class="info-section">
        {% if recipe.treats %}
        <h3>ğŸ¥ Äiá»u trá»‹</h3>
        <p>{{ recipe.treats|linebreaks }}</p>
        {% endif %}
        
        {% if recipe.benefits %}
        <h3>âœ¨ CÃ´ng dá»¥ng</h3>
        <p>{{ recipe.benefits|linebreaks }}</p>
        {% endif %}
    </div>
    {% endif %}

    <!-- NguyÃªn liá»‡u -->
    <div class="info-section">
        <h3>ğŸŒ¿ NguyÃªn liá»‡u</h3>
        <div class="ingredient-box">
            <h4>NguyÃªn liá»‡u chÃ­nh:</h4>
            <p>{{ recipe.main_ingredient|linebreaks }}</p>
            
            {% if recipe.additional_ingredients %}
            <h4>NguyÃªn liá»‡u phá»¥:</h4>
            <p>{{ recipe.additional_ingredients|linebreaks }}</p>
            {% endif %}
        </div>
    </div>

    <!-- CÃ¡ch cháº¿ biáº¿n -->
    <div class="info-section">
        <h3>ğŸ‘¨â€ğŸ³ CÃ¡ch cháº¿ biáº¿n</h3>
        <div class="preparation-steps">
            {{ recipe.preparation_steps|linebreaks }}
        </div>
    </div>

    <!-- Sá»­ dá»¥ng -->
    <div class="info-section">
        <h3>ğŸ’Š CÃ¡ch sá»­ dá»¥ng</h3>
        <div class="usage-box">
            <h4>Liá»u lÆ°á»£ng:</h4>
            <p>{{ recipe.dosage|linebreaks }}</p>
            
            {% if recipe.duration %}
            <h4>Thá»i gian Ä‘iá»u trá»‹:</h4>
            <p>{{ recipe.duration }}</p>
            {% endif %}
            
            {% if recipe.storage %}
            <h4>Báº£o quáº£n:</h4>
            <p>{{ recipe.storage|linebreaks }}</p>
            {% endif %}
        </div>
    </div>

    <!-- Cáº£nh bÃ¡o -->
    {% if recipe.warnings or recipe.contraindications %}
    <div class="info-section warning-section">
        <h3>âš ï¸ Cáº£nh bÃ¡o vÃ  lÆ°u Ã½</h3>
        {% if recipe.warnings %}
        <div class="warning-box">
            <strong>Cáº£nh bÃ¡o:</strong>
            <p>{{ recipe.warnings|linebreaks }}</p>
        </div>
        {% endif %}
        
        {% if recipe.contraindications %}
        <div class="warning-box">
            <strong>Chá»‘ng chá»‰ Ä‘á»‹nh:</strong>
            <p>{{ recipe.contraindications|linebreaks }}</p>
        </div>
        {% endif %}
    </div>
    {% endif %}

    <!-- Ghi chÃº -->
    {% if recipe.notes %}
    <div class="info-section">
        <h3>ğŸ“ Ghi chÃº thÃªm</h3>
        <p>{{ recipe.notes|linebreaks }}</p>
    </div>
    {% endif %}

    <!-- Recipe Gallery -->
    {% if recipe.images.exists %}
    <div class="info-section">
        <h3>ğŸ“¸ HÃ¬nh áº£nh minh há»a</h3>
        <div class="recipe-gallery">
            {% for img in recipe.images.all %}
            <div class="gallery-item">
                <img src="{{ img.image.url }}" alt="{{ img.caption|default:recipe.name }}">
                {% if img.caption %}
                <p class="gallery-caption">{{ img.caption }}</p>
                {% endif %}
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}

    <!-- Nguá»“n -->
    <div class="recipe-footer">
        {% if recipe.source %}
        <p><strong>Nguá»“n:</strong> {{ recipe.source }}</p>
        {% endif %}
        {% if recipe.created_by %}
        <p><strong>NgÆ°á»i táº¡o:</strong> {{ recipe.created_by.username }}</p>
        {% endif %}
        <p><strong>Cáº­p nháº­t:</strong> {{ recipe.updated_at|date:"d/m/Y H:i" }}</p>
    </div>
</div>
{% endblock %}
